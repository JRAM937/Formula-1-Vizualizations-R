---
title: "Final Project"
output: github_document
author: "Adrian Ortiz, Juan Ramirez JR"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, comment="")
library(tidyverse)
library(lubridate)
library(scales)
library(readr)
#include other packages needed here
```

```{r, eval=FALSE, include=FALSE}
#include data cleaning code here, with comments on what each step is doing the indicators above eval=FALSE and include=FALSE will stop the code from running again when you knit the document while still keeping the code in the document
#use write_csv() to write your tidy data into a new csv file
```

```{r}
#use read_csv() to import your new tidy data include any variable specifications here as needed
driver_standings <- read.csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-07/driver_standings.csv")
qualifying_times <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-07/qualifying.csv")
constructor_standings <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-07/constructor_standings.csv")
constructors <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-09-07/constructors.csv")
```

## Introduction
Description of data and problem(s) you are solving.  Include data source(s) here, either through citation or link to webpage.
>Question 1: Of the fastest drivers in Qualifying Round #3, who has the most wins in Abu Dhabi?
>Question 2: Which team had the most wins in the 2021 season?

## Graphic 1
Provide a brief description of your goal with your created graphic and what it demonstrates
```{r}
#include code for any data manipulation and variable creation used to create the graphic as well as the code for the graph creation - be sure to comment all code with description of steps being completed with each line of code
qualifying_times %>% 
  mutate(q3 = replace(q3, q3 == "\\N", "0.0")) %>% 
  filter(raceId == "17") %>% 
  select(driverId, q3) %>% 
  filter(q3 != "0.0") %>% 
  arrange(q3) %>% 
  write_csv("clean_times.csv")
```

```{r}
driver_standings %>% 
  filter(raceId == "17") %>% 
  mutate(label = driverId) %>% 
  write_csv("clean_drivers.csv") %>% 
  
  top_n(3, wins) %>%
  ggplot(aes(x = driverId, y = wins)) +
  geom_col(aes(fill = wins, x = reorder(driverId, wins), y = wins), show.legend = FALSE) +
  labs(title = "Fastest Q3 Drivers' wins in Abhu Dhabi GP (any year)")
```
> The fastest driver from Q3 with the most wins in Abu Dhabi is driverId #18, which is Jenson Button.

## Graphic 2 - Which team had the most wins in the 2021 season?
Provide a brief description of your goal with your created graphic and what it demonstrates
```{r}
#include code for any data manipulation and variable creation used to create the graphic as well as the code for the graph creation - be sure to comment all code with description of steps being completed with each line of code
constructor_standings %>%
  filter(wins != 0) %>% 
  arrange(desc(wins)) %>% 
  write_csv("clean_constructor_standings.csv") %>% 

  top_n(10, wins) %>% 
  ggplot(aes(x = constructorId, y = wins)) +
    geom_col(aes(fill = wins, x = reorder(constructorId, wins), y = wins), show.legend = FALSE) +
    labs(title = "Teams with the most wins (Total)") + 
    theme_classic()

```
